<!DOCTYPE html>
<html>
<head>
	<title>MouseBoxes</title>
	<script src="js/jquery.js"></script>
	<script>
		$(document).ready(function(){


			var sideLen = 100;

			var rows = Math.floor(($(".mouseBoxWrapper").height() + sideLen/2) / sideLen);
			var columns = Math.floor( ($(".mouseBoxWrapper").width() + sideLen/2) / sideLen);

			console.log("row " + rows + " " + columns)


			var bodyString = "";
			for(var i = 0; i < rows; i++){
				for(var j = 0; j < columns; j++){
					bodyString += "<div class=\"mouseBox row-"+i+" col-"+j+"\"></div>";
				}
			} 

			//Appending the string to the document
			$(".mouseBoxWrapper").html(bodyString);
			$(".mouseBox").css("height", sideLen).css("width", sideLen);

			//Storing the information
			var initialX = [];
			var initialY = [];
			var radius = sideLen / 2;

			$(".mouseBox").each(function(index) {
				var offset = $(this).offset();
				initialX[index] = offset.left + sideLen / 2;
				initialY[index] = offset.top + sideLen / 2;
			});

			$(".mouseBox").css("margin", 2);
			//Storing the objects
			// for(var i = 0$(".mouseBox");
			var initial = true;
			$(document).mousemove(function(e){
				if(initial) {
					$(".mouseBox").css("margin", 0);
					initial = false;
				}
				$(".mouseBox").each(function(index){
					var newX, newY;
					var oldX = initialX[index];
					var oldY = initialY[index];

					var xDiff = oldX - e.pageX;
					var yDiff = oldY - e.pageY;

					//Getting the diff
					var xPos = 1;
					if(xDiff < 0) {
						xPos = -1;
						xDiff *= -1;
					}

					var yPos = 1;
					if(yDiff < 0) {
						yPos = -1;
						yDiff *= -1;
					}

					var distX = Math.sqrt(xDiff);
					var distY = Math.sqrt(yDiff);

					newX = oldX + (distX* xPos) - radius;
					newY = oldY + (distY* yPos) - radius;

					$(this).offset({top: newY, left: newX});
				});
 
			});

		});

			

	</script>
	<style type="text/css">
		.body {
			height: 100%;
		}
		.mouseBox {
			float: left;
			background-color: gray;
		}
		.mouseBoxWrapper {
			width: 80%;
			height: 500px;
			margin: 0 auto;
			margin-top: 10%;
			background-color: blue;
			/*overflow: hidden;*/
		}

	</style>
</head>
<body>
	<div class="mouseBoxWrapper"></div>
</body>
</html>